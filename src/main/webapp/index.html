<!DOCTYPE html>
<html ng-app="gls">

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<link rel="stylesheet" href="css/bootstrap.min.css" />
<link rel="stylesheet" href="css/grid.css" />


<title>SRS</title>

<!-- Bootstrap Core CSS -->
<link href="css/bootstrap.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="css/sb-admin.css" rel="stylesheet">

<!-- Morris Charts CSS -->
<link href="css/plugins/morris.css" rel="stylesheet">

<!-- Custom Fonts -->
<link href="font-awesome/css/font-awesome.min.css" rel="stylesheet"
	type="text/css">



</head>

<body ng-controller="family" onload="myFunction()">

	<div id="wrapper">

		<!-- Navigation -->
		<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-ex1-collapse">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" ng-click="backToHome()">Cognizant
					Shipping Solutions</a>
			</div>
			<!-- Top Menu Items -->
			<ul class="nav navbar-right top-nav">
				<li class="dropdown"><a class="dropdown-toggle"
					data-toggle="dropdown"><i class="fa fa-envelope"></i> <b
						class="caret"></b></a>
					<ul class="dropdown-menu message-dropdown">
						<li class="message-preview"><a>
								<div class="media">
									<span class="pull-left"> <img class="media-object"
										src="http://placehold.it/50x50" alt="">
									</span>
									<div class="media-body">
										<h5 class="media-heading">
											<strong>John Smith</strong>
										</h5>
										<p class="small text-muted">
											<i class="fa fa-clock-o"></i> Yesterday at 4:32 PM
										</p>
										<p>Lorem ipsum dolor sit amet, consectetur...</p>
									</div>
								</div>
						</a></li>
						<li class="message-preview"><a>
								<div class="media">
									<span class="pull-left"> <img class="media-object"
										src="http://placehold.it/50x50" alt="">
									</span>
									<div class="media-body">
										<h5 class="media-heading">
											<strong>John Smith</strong>
										</h5>
										<p class="small text-muted">
											<i class="fa fa-clock-o"></i> Yesterday at 4:32 PM
										</p>
										<p>Lorem ipsum dolor sit amet, consectetur...</p>
									</div>
								</div>
						</a></li>
						<li class="message-preview"><a>
								<div class="media">
									<span class="pull-left"> <img class="media-object"
										src="http://placehold.it/50x50" alt="">
									</span>
									<div class="media-body">
										<h5 class="media-heading">
											<strong>John Smith</strong>
										</h5>
										<p class="small text-muted">
											<i class="fa fa-clock-o"></i> Yesterday at 4:32 PM
										</p>
										<p>Lorem ipsum dolor sit amet, consectetur...</p>
									</div>
								</div>
						</a></li>
						<li class="message-footer"><a>Read All New Messages</a></li>
					</ul></li>
				<li class="dropdown"><a class="dropdown-toggle"
					data-toggle="dropdown"><i class="fa fa-bell"></i> <b
						class="caret"></b></a>
					<ul class="dropdown-menu alert-dropdown">
						<li><a>Alert Name <span class="label label-default">Alert
									Badge</span></a></li>
						<li><a>Alert Name <span class="label label-primary">Alert
									Badge</span></a></li>
						<li><a>Alert Name <span class="label label-success">Alert
									Badge</span></a></li>
						<li><a>Alert Name <span class="label label-info">Alert
									Badge</span></a></li>
						<li><a>Alert Name <span class="label label-warning">Alert
									Badge</span></a></li>
						<li><a>Alert Name <span class="label label-danger">Alert
									Badge</span></a></li>
						<li class="divider"></li>
						<li><a>View All</a></li>
					</ul></li>
				<li class="dropdown"><a class="dropdown-toggle"
					data-toggle="dropdown"><i class="fa fa-user"></i> Ragav <b
						class="caret"></b></a>
					<ul class="dropdown-menu">
						<li><a><i class="fa fa-fw fa-user"></i> Profile</a></li>
						<li><a><i class="fa fa-fw fa-envelope"></i> Inbox</a></li>
						<li><a><i class="fa fa-fw fa-gear"></i> Settings</a></li>
						<li class="divider"></li>
						<li><a><i class="fa fa-fw fa-power-off"></i> Log Out</a></li>
					</ul></li>
			</ul>
			<!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens -->
			<div class="collapse navbar-collapse navbar-ex1-collapse">


				<ul class="nav navbar-nav side-nav">
					<li><a ng-click="showSummary()" style="cursor: pointer;"><i
							class="fa fa-fw fa-shopping-cart"></i> Dashboard</a></li>

					<li><a ng-click="backToHome()" style="cursor: pointer;"><i
							class="fa fa-fw fa-shopping-cart"></i> Create Shipment</a></li>
					<li><a href="javascript:;" data-toggle="collapse"
						ng-show="showDta" data-target="#demo"><i
							class="fa fa-fw fa-bar-chart-o"></i> Generated Docs <i
							class="fa fa-fw fa-caret-down"></i></a>
						<ul id="demo" class="collapse" ng-show="showDta">
							<li><a data-toggle="pill" ng-click="showLabel('SHIP')"
								style="cursor: pointer;"> <i class="fa fa-fw fa-file-text"></i>Shipping
									Label
							</a></li>
							<li><a data-toggle="pill" ng-if="checkboxModel.value==true"
								ng-click="showLabel('RETURN')" style="cursor: pointer;"><i
									class="fa fa-fw fa-file-text"></i>Return Label </a></li>
							<li><a data-toggle="pill" ng-click="showLabel('COE')"
								style="cursor: pointer;"><i class="fa fa-fw fa-file-text"></i>Certificate
									of Origin </a></li>
						</ul></li>
					<li><a ng-click="showTracking()" style="cursor: pointer;"><i
							class="fa fa-fw fa-search"></i> Tracking / Void Shipment</a></li>
				</ul>
			</div>
			<!-- /.navbar-collapse -->
		</nav>

		<div id="page-wrapper">

			<div class="container-fluid">
				<div ng-show="load"
					style="top: 40%; left: 45%; right: 45%; position: absolute; z-index: 1070;">
					<img src="./images/loading.gif" />
				</div>
				<div class="row" ng-hide="!showDta" style="padding-top: 60px;">
					
					<div class="col-lg-10 col-md-10 col-sm-12 col-xs-12">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
							ng-show="shipLbl">
							<embed src="{{labelSrc}}" width="900" height="600"
								type='application/pdf'>
						</div>
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
							ng-show="returnLbl">
							<img ng-src="{{retimgSrc}}" style="height: 500px" />
						</div>
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
							ng-show="showInv">
							<embed src="{{COESrc}}" width="900" height="600"
								type='application/pdf'>
						</div>
					</div>
				</div>
				<div class="alert alert-danger" ng-show="showError">
					<a href="{{strUrl}}" class="close" data-dismiss="alert"
						aria-label="close">&times;</a> <strong>Error!</strong>
					{{errorDesc}}
				</div>
				<!-- Success Header Message -->
				<div class="alert alert-info" ng-show="showSuccess">
					<a href="{{strUrl}}" class="close" data-dismiss="alert"
						aria-label="close">&times;</a> <strong>Success!!</strong>
					{{statusDesc}}
				</div>
				<!-- End of Success Header Message-->
				
				<div ng-hide="showDta">
					<!-- <div class="col-lg-5" style="padding-top: 25px;">
						<label for="mySelect">Carrier:</label> <select name="mySelect"
							id="mySelect" ng-change="showRetLabel()"
							ng-options="option.name for option in data.availableOptions track by option.id"
							ng-model="data.selectedOption"></select>
					</div> -->
					<div class="row" ng-hide=tracking||summary>
						<!-- <div class="col-lg-3"
							style="height: 500px; vertical-align: middle;"> -->
						<div class="col-lg-3">
							<!-- <img src="./images/xml_5.png"
								style="height: 300px; padding-top: 15%; padding-left: 15%;"> -->
						<img src="./images/xml_5.png" style="height: 100px;">
						</div>
						<div class="col-lg-6">
							<div class="row">
								<div class="col-lg-5" style="padding-top: 25px;">
									<label for="mySelect">Carrier:</label> <select name="mySelect"
										id="mySelect" ng-change="showRetLabel()"
										ng-options="option.name for option in data.availableOptions track by option.id"
										ng-model="data.selectedOption"></select>
								</div>
								<div class="col-lg-7" style="padding-top: 15px;">
									<h4>
										Input XML to be pasted below
										</h3>
								</div>
							</div>
							<textarea rows="4" cols="50"
								class="form-control ng-pristine ng-untouched ng-valid"
								ng-model="xmlData" style="width: 680px; height: 350px;"></textarea>
							<br>
							<div class="row" style="width: 720px;">
								<div class="col-lg-3">
									<label ng-show="showRet"> <input type="checkbox"
										ng-model="checkboxModel.value"
										class="ng-pristine ng-untouched ng-valid"> Return
										Label
									</label>
								</div>
								<div class="col-lg-3"></div>
								<div class="col-lg-3"></div>
								<div class="col-lg-3" style="padding-left: 85px;">
									<button ng-click="processXML()" class="btn btn-info btn-sm"
										style="right: 45%">Proceed</button>
								</div>
							</div>
						</div>
					</div>

					<div class="row" ng-show="summary">


						<div class="col-lg-12">

							<div class="row" ng-hide=tracking>

								<div class="col-lg-12">
									<ol class="breadcrumb">
										<li class="active"><i class="fa fa-dashboard"></i>
											Dashboard</li>
										<div id="reportrange" class="pull-right"
											style="background: #fff; cursor: pointer; padding: 1px 1px; border: 1px solid #ccc; width: 30%;"dateRange">
											<i class="glyphicon glyphicon-calendar fa fa-calendar"></i>&nbsp;
											<span></span> <b class="caret"></b>
										</div>
									</ol>
								</div>
							</div>


							<!-- <div padding-top: 10x ng-repeat="orderSummary in orderSummaryAll"> -->
								
								
								<div class="col-lg-2 col-md-6">
									<div class="panel panel-green">
										<div class="panel-heading">
											<div class="row">
												<div align="center">
													<div class="huge">{{ orderSummaryAll[1].value}}</div>
													<div>{{ orderSummaryAll[1].columnName }}</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-lg-2 col-md-6">
									<div class="panel panel-primary">
										<div class="panel-heading">
											<div class="row">
												<div align="center">
													<div class="huge">{{ orderSummaryAll[2].value}}</div>
													<div>{{ orderSummaryAll[2].columnName }}</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-lg-2 col-md-6">
									<div class="panel panel-yellow">
										<div class="panel-heading">
											<div class="row">
												<div align="center">
													<div class="huge">{{ orderSummaryAll[3].value}}</div>
													<div>{{ orderSummaryAll[3].columnName }}</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-lg-2 col-md-6">
									<div class="panel panel-green">
										<div class="panel-heading">
											<div class="row">
												<div align="center">
													<div class="huge">{{ orderSummaryAll[0].value}}</div>
													<div>{{ orderSummaryAll[0].columnName }}</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-lg-2 col-md-6">
									<div class="panel panel-red">
										<div class="panel-heading">
											<div class="row">
												<div align="center">
													<div class="huge">{{ orderSummaryAll[4].value}}</div>
													<div>{{ orderSummaryAll[4].columnName }}</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-lg-2 col-md-6">
									<div class="panel panel-primary">
										<div class="panel-heading">
											<div class="row">
												<div align="center">
													<div class="huge">{{ orderSummaryAll[5].value}}</div>
													<div>{{ orderSummaryAll[5].columnName }}</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							<!-- </div> -->



							<!-- /.row -->
							<div class="row">

								<div class="col-lg-12">
									<div class="panel panel-default">
										<div class="panel-heading">Orders</div>
										<div class="panel-body">
											<div id="chart1"></div>
										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-lg-6">
									<div class="panel panel-default">
										<div class="panel-heading">PieChart</div>
										<div class="panel-body">
											<div id="chart2"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="row" style="vertical-align: middle; padding-top: 50px"
						ng-show="tracking">
						<div class="row" ng-hide=showDta||summary>
							<div class="col-lg-3" style="padding-top: 5%;">
								<img src="./images/tracking.png" style="height: 220px" />
							</div>
							<div class="row" style="padding-top: 5%;">
								<div class="row">
									<div class="col-lg-3" style="padding-top: 50px;">
										<label for="inputTN">Enter Tracking number :</label> <input
											class="form-control input-sm" ng-model="trackingNum"
											id="inputTN" type="text">
									</div>
									<div class="col-lg-2" style="padding-top: 75px;">
									<button ng-bind="buttonVariable" type="button" ng-click="trackShipment(buttonVariable)"
										class="btn btn-info btn-sm"> </button>
								</div>
								<div class="col-lg-2" style="padding-top: 75px;">
									<label ng-show="showVoid"> <input type="checkbox"
										ng-model="checkboxModel.value" ng-change="modifyButtonName(checkboxModel.value)" 
										class="ng-pristine ng-untouched ng-valid"> Void Shipment by Tracking Number</label>
									
								</div>
								<div class="col-lg-8" style="padding-top: 25PX;">
									<table class="table table-bordered" ng-show="showProg">
										<thead>
											<tr>
												<th>City</th>
												<th>State</th>
												<th>Status</th>
												<th>Date and Time</th>
											</tr>
										</thead>
										<tr ng-repeat="x in activities">
											<td>{{ x.ActivityLocation.Address.city }}</td>
											<td>{{ x.ActivityLocation.Address.stateProvinceCode }}</td>
											<td>{{ x.Status.StatusType.Description }}</td>
											<td>{{ x.Date }} {{x.Time}}</td>
										</tr>
										</table>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3" style="padding-top: 5%;">
							<img src="./images/tracking.png"
								style="height: 180px; visibility: hidden;">
						</div>
					</div>
					<div>
						<div class="col-lg-3" style="padding-top: 5%;">
							<img src="./images/tracking.png"
								style="height: 180px; visibility: hidden;">
						</div>
						<div class="col-lg-3" style="padding-top: 5%;">
							<img src="./images/tracking.png"
								style="height: 180px; visibility: hidden;">
						</div>
					</div>
					<!-- /.container-fluid -->

				</div>
				<!-- /#page-wrapper -->

			</div>
			<!-- /#wrapper -->

			<!-- jQuery -->
			<script src="js/jquery.js"></script>

			<!-- Bootstrap Core JavaScript -->
			<script src="js/bootstrap.min.js"></script>
			<script src="lib/angular.min.js"></script>


			<script language="javascript" type="text/javascript"
				src="js/jquery.min.js"></script>
			<script language="javascript" type="text/javascript"
				src="js/jquery.jqplot.min.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.barRenderer.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.pieRenderer.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.categoryAxisRenderer.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.pointLabels.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.canvasTextRenderer.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.canvasAxisTickRenderer.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.pieRenderer.js"></script>
			<script type="text/javascript"
				src="js/plugins/jq/jqplot.donutRenderer.js"></script>
			<link rel="stylesheet" type="text/css"
				href="js/jquery.jqplot.min.css" />
			<!-- Include Required Prerequisites -->
			<script type="text/javascript" src="js/plugins/dp/moment.min.js"></script>
			<script type="text/javascript" src="js/plugins/json/json2.js"></script>


			<!-- Include Date Range Picker -->
			<script type="text/javascript" src="js/plugins/dp/daterangepicker.js"></script>
			<link rel="stylesheet" type="text/css"
				href="js/plugins/dp/daterangepicker.css" />



			<script type="text/javascript">
			var serviceSummaryAll;
			var  serviceSummaryById;
			var firstTimeLoad = true;
		    var dbFromDate;
		    var dbToDate;
		    var extScope;
		   

		    function myFunction() {
				 firstTimeLoad=true;
				
			}
			
		    function getAllSummary ($http,reportRequest) {
			    console.log('getAllSummaryCalled');
		    	$http
				.post('./rest/Report/getStatusSummaryForAll',reportRequest)
				.success(
						function(resp, status) {	
												
							serviceSummaryAll  = resp.serviceSummaryList;							
							extScope.orderSummaryAll = resp.orderSummaryList;
							drawChart();					
						}).error(function(error, status) {
							//$scope.load = false;
				}); 
				
			}
			
	    function cb(start, end) {   	
		    console.log('cb')   
		     $('#reportrange span').html(start.format('MMMM D, YY') + ' - ' + end.format('MMMM D, YY')); 
		     console.log(firstTimeLoad);
	    	
		    dbFromDate = start.format('YYYY-MM-DD') ;
		    dbToDate = end.format('YYYY-MM-DD') ;
		    var reportRequest = {
					requestType : 'getStatusSummaryForAll',								
					fromDate:dbFromDate,
					toDate:dbToDate
				};

		    if (firstTimeLoad) {
		    	firstTimeLoad=false;
	    		
	        } else{
	        	var $http = angular.element('html').injector().get('$http');	        	
	   		 	getAllSummary($http, reportRequest); 
	   		 	
		    } 
		    
	    	// alert("A new date range was chosen: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
	       
	      
	        
	        
		  
	    }
	    
	    cb(moment(), moment());

	    $('#reportrange').daterangepicker({
	    	locale: {
	    	      format: 'YYYY-MM-DD'
	    	    },
	        ranges: {
	           'Today': [moment(), moment()],
	           'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
	           'Last 7 Days': [moment().subtract(6, 'days'), moment()],
	           'Last 30 Days': [moment().subtract(29, 'days'), moment()],
	           'This Month': [moment().startOf('month'), moment().endOf('month')],
	           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
	        }
	    }, cb);




	    function CreateBarChartOptions() {
	    	   
	        var optionsObj = {

	        		 // Only animate if we're not using excanvas (not in IE 7 or IE 8)..
	                title: 'Totol Sales Orders',
	                height: 450,
	                width: 980,
	                animate: !$.jqplot.use_excanvas,
	                seriesDefaults:{
	                    renderer:$.jqplot.BarRenderer,
	                    pointLabels: { show: true },
	                	 rendererOptions: {
	                		 fillToZero: true,
	                		 varyBarColor: true
	                    	//barDirection: 'horizontal'
	                	}
	                },
	                axesDefaults: {
	                    tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
	                   
	                },
	                axes: {             
	                    xaxis: {
	                        renderer: $.jqplot.CategoryAxisRenderer,
	                        //ticks: ticks,                 
	                        tickOptions: {
	                            angle: -55,
	                           
	                          }                 
	                    }
	                },
	                highlighter: { show: false }
	           
	        };
	        return optionsObj;
	    }

	    function drawPieChart() {

	    	console.log(serviceSummaryById);
	    	var pieChartData  =  new Array();
	    	
	   	 for( var i in serviceSummaryById ) {
	   		
	   		pieChartData[i]  = new Array();
	   		pieChartData[i][0] = serviceSummaryById[i].columnName;
	   		pieChartData[i][1] = serviceSummaryById[i].value;
	   		
	   	 }
	   	 var plot2 = jQuery.jqplot ('chart2', [pieChartData], 
	   		    {
	   		      seriesDefaults: {
	   		        renderer: jQuery.jqplot.PieRenderer, 
	   		        rendererOptions: {
	   		          // Turn off filling of slices.
	   		          fill: false,
	   		          showDataLabels: true, 
	   		          // Add a margin to seperate the slices.
	   		          sliceMargin: 4, 
	   		          // stroke the slices with a little thicker line.
	   		          lineWidth: 5
	   		        }
	   		      }, 
	   		      legend: { show:true, location: 'e', }
	   		    }
	   		  );
           
	    	           
		}
		
function drawChart() {	
	
	 $.jqplot.config.enablePlugins = true;    
	
	 if(serviceSummaryAll === undefined) {
	 	console.log('serviceSummaryAll not defined');
	 } else {
		 console.log(serviceSummaryAll);
	 }
	var barChartData  =  new Array();
	
	 for( var i in serviceSummaryAll ) {
		
		 barChartData[i]  = new Array();
		 barChartData[i][0] = serviceSummaryAll[i].columnName;
		 barChartData[i][1] = serviceSummaryAll[i].value;
		
	 }
	    
    console.log(barChartData.length);
    if(barChartData.length>0) {
    if(firstTimeLoad) {  
        firstTimeLoad=false;    
        
    	plot1 = $.jqplot('chart1', [barChartData], CreateBarChartOptions());
    } else { 
    	   	
    	plot1 = $.jqplot('chart1', [barChartData],CreateBarChartOptions()).replot();
    }
    }
      $('#chart1').bind('jqplotDataClick', 
         function (ev, seriesIndex, pointIndex, data) {
          console.log('jqplot' + serviceSummaryAll[pointIndex].columnName);
          var reportRequest = {
					requestType : 'getStatusSummaryById',								
					fromDate:dbFromDate,
					toDate:dbToDate,
					carrierServiceType:serviceSummaryAll[pointIndex].columnId
			};
            var $http = angular.element('html').injector().get('$http');	        	
 		 	;
	    	$http
			.post('./rest/Report/getStatusSummaryForAll',reportRequest)
			.success(
					function(resp, status) {	
						
						 //$('#info1').html('series: '+seriesIndex+', point: '+pointIndex+', data: '+data);
						 console.log(resp);
						serviceSummaryById = resp.serviceSummaryByIdList;
						 drawPieChart();
											
					}).error(function(error, status) {
						//$scope.load = false;
			}); 
			
           
             
         }
     ); 

}



</script>
</body>

<script type="text/javascript">
	var gls = angular
			.module('gls', [])
			.controller(
					'family',
					function($scope, $window, $http) {
						$scope.buttonVariable = "Track";
						$scope.statusDesc ="";
						$scope.showSuccess = false;
						$scope.tracking = false;
						$scope.summary = false;
						$scope.styleWid = "width:100%";
						$scope.deliverySts = "";
						$scope.shipLbl = true;
						$scope.returnLbl = false;
						$scope.showInv = false;
						$scope.showProg = false;
						$scope.activities = null;
						$scope.isUPS = true;
						$scope.showRet = true;
						$scope.checkboxModel = {
							value : false,
						};
						$scope.data = {
							availableOptions : [ {
								id : 'UPS',
								name : 'UPS'
							}, {
								id : 'YRC',
								name : 'YRC'
							}, {
								id : 'FEDEX',
								name : 'FEDEX'
							},{
								id : 'PUROLATOR',
								name : 'PUROLATOR'
							} ],
							selectedOption : {
								id : 'UPS',
								name : 'UPS'
							}
						//This sets the default value of the select in the ui
						};
						$scope.modifyButtonName = function($event) {
							
							if($event == true)
							{
								$scope.buttonVariable = "Void Shipment"
								
							} else {
								$scope.buttonVariable = "Track"
							}
							
						}
						$scope.showRetLabel = function() {
							$scope.checkboxModel.value = false;
							if ($scope.data.selectedOption.name == "UPS" || 
									$scope.data.selectedOption.name == "FEDEX") {
								$scope.showRet = true;
							} else {
								$scope.showRet = false;
							}
							$scope.buttonVariable = "Track";
							$scope.trackingNum = "";
							$scope.showError = false;
							$scope.showProg = false;
							$scope.showSuccess = false;
						}
						$scope.showSummary = function () {	
							$scope.buttonVariable = "Track";
							$scope.checkboxModel = {
									value : false,
							};
							extScope = $scope;			
						
							$scope.summary = true;
							$scope.tracking = false;
							$scope.showDta = false;
							$scope.showProg = false;
							$scope.showDta = false;
							$scope.load = false;
							$scope.xmlData = "";
							$scope.trackingNum = "";
							
							 var reportRequest = {
									requestType : 'getStatusSummaryForAll',								
									fromDate:dbFromDate,
									toDate:dbToDate
								};
							 $scope.load=true;
							 $http
								.post('./rest/Report/getStatusSummaryForAll',reportRequest)
								.success(
										function(resp, status) {
											$scope.load=false;
											$scope.orderSummaryAll = resp.orderSummaryList;													
											serviceSummaryAll = resp.serviceSummaryList	;
											console.log(serviceSummaryAll);		
											drawChart();																						
										}).error(function(error, status) {
											$scope.load = false;
								}); 

								
										
																					
						}
						$scope.showTracking = function() {
							$scope.showSuccess = false;
							$scope.checkboxModel = {
									value : false,
							};
							$scope.buttonVariable = "Track";
							$scope.showVoid = true;
							$scope.tracking = true;
							$scope.summary=false;
							$scope.showDta = false;
							$scope.showProg = false;
							$scope.showDta = false;
							$scope.load = false;
							$scope.xmlData = "";
							$scope.trackingNum = "";
							$scope.showError = false;
						}
						$scope.backToHome = function() {
							$scope.showSuccess = false;
							$scope.checkboxModel = {
									value : false,
							};
							$scope.summary=false;
							$scope.buttonVariable = "Track";
							$scope.showError = false;
							$scope.tracking = false;
							$scope.showDta = false;
							$scope.showProg = false;
							$scope.showDta = false;
							$scope.load = false;
							$scope.showRet = true;
							$scope.xmlData = "";
							$scope.trackingNum = "";
							//checkboxModel.value = false;
							$scope.data = {
								availableOptions : [ {
									id : 'UPS',
									name : 'UPS'
								}, {
									id : 'FEDEX',
									name : 'FEDEX'
								},  {
									id : 'YRC',
									name : 'YRC'
								}, {
									id : 'PUROLATOR',
									name : 'PUROLATOR'
								}],
								selectedOption : {
									id : 'UPS',
									name : 'UPS'
								}
							//This sets the default value of the select in the ui
							};
						}

						$scope.trackShipment = function(selectedValue) {
							$scope.showSuccess = false;
							$scope.strUrl = window.location.href;
							$scope.strUrl = $scope.strUrl.replace("/#", "");
							$scope.showError = false;
							$scope.load = true;
							var selectedUrl = '';
							var isTracking = false;
							if (selectedValue === 'Track') {
								selectedUrl = './rest/Tracking/trackingdetails';
								isTracking = true;
							} else {
								selectedUrl = './rest/ManageShipping/cancelshipment';
							}
							
							$http
								.get(
										selectedUrl,
										{
											transformRequest : angular.identity,
											headers : {
												'Content-Type' : undefined
											},
											params : {
												'trackingNumber' : $scope.trackingNum,
												'carrierName' : $scope.data.selectedOption.name
											}
										})
								.success(
										function(resp, status) {
											if (isTracking) {
												if (resp.responseStatusCode == "1") {
													$scope.response = resp;
													$scope.activities = $scope.response.shipment[0]._package[0].Activity;
													$scope.load = false;
													$scope.showError = false;
													$scope.showProg = true;
												} else if (resp.responseStatusCode == "0") {
													$scope.load = false;
													$scope.showProg = false;
													$scope.errorDesc = resp.error[0].errorDescription;
													$scope.showError = true;
												}
											} else { 
												if (resp.status == "1" ){
													$scope.statusDesc =  'The Shipment has been cancelled successfully.. ';
													$scope.load = false;
													$scope.showError = false;
													$scope.showSuccess = true;
												} else {
													$scope.load = false;
													$scope.showProg = false;
													$scope.errorDesc = resp.errorDescription;
													$scope.showError = true;
													$scope.showSuccess = false;
												}
											}
										}).error(function(error, status) {
										$scope.load = false;
									});
						}
						$scope.processXML = function() {
							var bfr = $scope.xmlData.replace(/(<[a-z A-Z]:)/g,
									'<');
							var frmData = new FormData();
							$scope.strUrl = window.location.href;
							$scope.strUrl = $scope.strUrl.replace("/#", "");
							var aftr = bfr.replace(/(<\/[a-z A-Z]:)/g, '</');
							$scope.load = true;
							frmData.append('FILEUPLOAD', aftr);
							frmData.append('CARRIER',
									$scope.data.selectedOption.name);
							frmData
									.append('GENLBL',
											$scope.checkboxModel.value);
							$http
									.post(
											'./rest/ManageShipping/importXMLFile',
											frmData,
											{
												transformRequest : angular.identity,
												headers : {
													'Content-Type' : undefined
												}
											})
									.success(
											function(resp, status) {
												$scope.response = resp
												if (resp.status == null
														|| resp.status == "Failure"
														|| resp.status == "FAILURE") {
													$scope.showDta = false;
													$scope.load = false;
													$scope.errorDesc = resp.errorDescription;
													$scope.showError = true;
												} else {
													var str = window.location.href;
													str = str.replace("/#", "");
													if ($scope.data.selectedOption.name == "UPS" ) {
														$scope.retimgSrc = str
																+ "/ShipLabels/Return_"
																+ $scope.response.trackingNumber
																+ ".png";
													} else if( $scope.data.selectedOption.name == "FEDEX") {
														$scope.retimgSrc = str
															+ "/ShipLabels/Return_"
															+ $scope.response.returnLblTrackingNum
															+ ".png";
													}
													for ( var shipmentdoc in $scope.response.shipmentDocuments) {
														if ($scope.response.shipmentDocuments[shipmentdoc].documentTitle == "CO") {
															$scope.COESrc = str
																	+ "/ShipLabels/"
																	+ $scope.response.shipmentDocuments[shipmentdoc].documentName;
														}
														if ($scope.response.shipmentDocuments[shipmentdoc].documentTitle == "SHIPPINGLABEL") {
															$scope.labelSrc = str
																	+ "/ShipLabels/"
																	+ $scope.response.shipmentDocuments[shipmentdoc].documentName;
														}
													}

													$scope.showDta = true;
													$scope.load = false;
													$scope.showError = false;
												}
											}).error(function(error, status) {
										$scope.showDta = false;
										$scope.load = false;
										$scope.showError = true;
									});
						}
						$scope.showLabel = function(lblName) {
							if (lblName == 'SHIP') {
								$scope.shipLbl = true;
								$scope.returnLbl = false;
								$scope.showInv = false;
							} else if (lblName == 'RETURN') {
								$scope.shipLbl = false;
								$scope.returnLbl = true;
								$scope.showInv = false;
							} else {
								$scope.shipLbl = false;
								$scope.returnLbl = false;
								$scope.showInv = true;
							}

						}

					});

	gls.directive('file', function() {
		return {
			scope : {
				file : '='
			},
			link : function(scope, el, attrs) {

				var r = new RegExp(/\.(docx|pdf)$/i);
				el.bind('change', function(event) {
					var files = event.target.files;
					var file = files[0];

					if (r.test(file.name)) {
						scope.$parent.addScreen.fileconverter.$valid = true;
						scope.file = file;
						scope.$apply();

					} else {
						scope.$parent.addScreen.fileconverter.$valid = false;
						scope.$apply();
					}
				});
			}
		};
	});
</script>
</html>

